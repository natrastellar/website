!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Gifffer",[],t):"object"==typeof exports?exports.Gifffer=t():e.Gifffer=t()}(this,function(){function a(i,r,a,o){var n,s=e.createElement("BUTTON"),l=a.getAttribute("class"),d=a.getAttribute("id");l?s.setAttribute("class",a.getAttribute("class")):null,d?s.setAttribute("id",a.getAttribute("id")):null,s.setAttribute("style","position:relative;cursor:pointer;background:none;border:none;padding:0;"),s.setAttribute("aria-hidden","true");var f=e.createElement("DIV");f.setAttribute("class","gifffer-play-button"),f.setAttribute("style","width:"+t+"px;height:"+t+"px;border-radius:"+t/2+"px;background:rgba(0, 0, 0, 0.3);position:absolute;top:50%;left:50%;margin:-"+t/2+"px");var u=e.createElement("DIV");return u.setAttribute("style","width:0;height: 0;border-top:14px solid transparent;border-bottom:14px solid transparent;border-left:14px solid rgba(0, 0, 0, 0.5);position:absolute;left:26px;top:16px;"),f.appendChild(u),o&&(n=e.createElement("p"),n.setAttribute("class","gifffer-alt"),n.setAttribute("style","border:0;clip:rect(0 0 0 0);height:1px;overflow:hidden;padding:0;position:absolute;width:1px;"),n.innerText=o+", image"),s.appendChild(f),a.parentNode.replaceChild(s,a),o?s.parentNode.insertBefore(n,s.nextSibling):null,{c:s,p:f}}function o(e,t,i,r,a){var o=e.parentNode.offsetWidth,s=(e.parentNode.offsetHeight,r/a);return t.toString().indexOf("%")>0?(t=parseInt(t.toString().replace("%","")),t=t/100*o,i=t/s):i.toString().indexOf("%")>0&&(i=parseInt(i.toString().replace("%","")),i=i/100*o,t=i/s),{w:t,h:i}}function n(e,t,i){var r,n,s,l,d,f,u,c,g,v,p,m,b,h=!1;r=e.getAttribute("data-gifffer"),l=e.getAttribute("data-gifffer-width"),d=e.getAttribute("data-gifffer-height"),f=e.getAttribute("data-gifffer-duration"),b=e.getAttribute("data-gifffer-alt"),e.style.display="block",s=document.createElement("canvas"),v=!(!s.getContext||!s.getContext("2d")),l&&d&&v&&(g=a(l,d,e,b)),e.onload=function(){v&&(l=l||e.width,d=d||e.height,g||(g=a(l,d,e,b)),n=g.c,u=g.p,m=o(n,l,d,e.width,e.height),t.push(n),n.addEventListener("click",function(){clearTimeout(p),h?(h=!1,n.appendChild(u),n.removeChild(c),n.appendChild(s),c=null,window.onscroll()):(h=!0,c=document.createElement("IMG"),c.setAttribute("style","width:100%;height:100%;"),c.setAttribute("data-uri",Math.floor(1e5*Math.random())+1),c.onload=function(){n.removeChild(u),n.removeChild(s),n.appendChild(c),window.onscroll()},parseInt(f)>0&&(p=setTimeout(function(){h=!1,c=null},f)),setTimeout(function(){c.src=r},0))}),s.width=m.w,s.height=m.h,s.getContext("2d").drawImage(e,0,0,m.w,m.h),n.appendChild(s),i(),n.setAttribute("style","position:relative;cursor:pointer;width:"+m.w+"px;height:"+m.h+"px;background:none;border:none;padding:0;"),s.style.width="100%",s.style.height="100%",l.toString().indexOf("%")>0&&d.toString().indexOf("%")>0?(n.style.width=l,n.style.height=d):l.toString().indexOf("%")>0?(n.style.width=l,n.style.height="inherit"):d.toString().indexOf("%")>0?(n.style.width="inherit",n.style.height=d):(n.style.width=m.w+"px",n.style.height=m.h+"px"))},e.src=r}var e=document,t=60,i=function(t){var i,r=0,a=[];for(i=e.querySelectorAll("[data-gifffer]");r<i.length;++r)n(i[r],a,t);return a};return i});