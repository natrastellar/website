<!DOCTYPE html><html><head><title>Alex Plagman - Blog</title><meta name="viewport" content="width=device-width,initial-scale=1"><link href="../../../../css/main.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"></head><body><header id="home"><div id="menuButton" class="menu-button">Menu</div><nav id="mainNav"><ul class="flexnav one-page" data-breakpoint="850"><li class="navLink"><a href="../../../../">Home</a></li><li class="navLink"><a href="../../../../#portfolio">Portfolio</a></li><li onclick="$(window).scrollTo($('footer'), 400);">Contact</li><li class="navLink"><a href="../../../">Blog</a></li></ul></nav></header><div id="content"><section id="entry" date="2016/10/19"><div id="entryTitle"><h1>Broken Shadows: Fighting the Lighting<span id="entryTimeStamp">Posted on 10/19/2016</span></h1></div><p class="visModule">As a student, I enjoy creating prototypes of games in my free time. I find it to be a reliable creative outlet as well as an exciting way to become better at programming. I don't have enough ability in other areas of game development (i.e. graphics and sound design) to create full-fledged games on my own, but I do love to solve problems on the technical side.</p><p class="visModule">Earlier this year, I started work on a simple 2D tile engine. I had no major plans for the project, but was interested in learning what elements are required for 2D grid-based games such as the recently-popular&nbsp;<a href="http://stardewvalley.net/">Stardew Valley</a>,&nbsp;<a href="http://rimworldgame.com">RimWorld</a>, or even a game as old as The Legend of Zelda: A Link to the Past:</p><div class="visModule"><figure></figure><figcaption>A Link to the Past features gridless movement in a 2D world.</figcaption><button class="loadimg" data-url="../../../../img/lttp.jpg">Load Image</button></div><p class="visModule">I started off with extremely basic functionality: the ability to pan a grid of tiles around on screen using the arrow keys. My next step was to implement a "character" who could travel throughout the grid. Games such as the ones mentioned above complicate the business by adding layered sprites and special collision detection. I implemented neither of these. Instead, I used one layer of sprites and categorized tiles into one of two options: "floor" or "wall".</p><div class="visModule"><figure></figure><figcaption>The original look of Broken Shadows, featuring movement entirely constrained to tiles.</figcaption><button class="loadimg" data-url="../../../../img/bsmove.gif">Load Image</button></div><p class="visModule">It was around this point where I realized turning my tile engine into something more could be an endeavor worth exploring. Originally, I had the notion of creating a simple 2D puzzle game where the player would shift tiles around to reach the goal. Most games built around this idea use buttons, switches, or various controllable tiles to accomplish it. I instead designed a system where certain non-ridged tiles would move around on their own&nbsp;<i>any time the player moves.</i></p><div class="visModule"><figure></figure><figcaption>Any valid player movement will attempt to shift every floating tile at the same time.</figcaption><button class="loadimg" data-url="../../../../img/bsshift.gif">Load Image</button></div><p class="visModule">I made this movement animation smooth later on, but the mechanics remain in the game. At this point, I had to decide what features would be crucial to the theme of the project. I decided upon the title "Broken Shadows", relating to a gameplay experience revolving around light and darkness. Originally, I toyed with spotlights, but decided it would be more educational to implement a proper visibility algorithm. I researched for a while and found&nbsp;<a href="http://www.redblobgames.com/articles/visibility/">several</a>&nbsp;<a href="http://journal.stuffwithstuff.com/2015/09/07/what-the-hero-sees/">articles</a>&nbsp;on 2D visibility, ultimately using the work of&nbsp;<a href="http://roy-t.nl/2014/02/27/2d-lighting-and-shadows-preview.html">Roy Triesscheijn</a>&nbsp;to avoid having to reinvent the wheel.</p><p class="visModule">Roy's algorithm treats every light occluder as a separate object with its own edges and vertices. This is fine in most cases but is highly inefficient for the smooth, connected walls of Broken Shadows. My first step was to enlist the help of a friend to design an algorithm that could join adjacent tiles together. Unfortunately, this had the side effect of revealing yet another problem within Roy's algorithm. Light sources have a radius, essentially creating a large box around the light which limits its range. By default, the algorithm had no way to detect whether this radius box was intersecting with the surrounding walls of the scene, causing some fairly obnoxious behavior:</p><div class="visModule"><figure></figure><figcaption>Unless, of course, you enjoy seeing through solid walls.</figcaption><button class="loadimg" data-url="../../../../img/bslightbug.gif">Load Image</button></div><p class="visModule">There are still a few errors within the lighting setup and the way the triangles are meshed together, as well as some unintended behavior of the segment joining code that ignores a certain edge case. I intend to work on these, but there are several other organizational elements that I need to rework in entirety as well before adding any new features. If nothing else, this project has served as excellent confirmation of the time required to even begin making a game of this size.</p><p class="visModule">In other news, I performed a minor rework of the entire site and finished setting up a system I like for this blog. Expect more to come in the future!</p><a id="jumpTop" class="visModule" onclick="$(window).scrollTo(0, 400);">Return to Top</a></section></div><footer><div id="footer_banner"><div><h1>Contact Me</h1><div><a id="gmail" class="social" href="mailto:alexplagman@gmail.com"><img src="http://www.alexplagman.com/img/mail.png"></a><a id="git" class="social" href="https://github.com/APlagman"><img src="http://www.alexplagman.com/img/GitHub-Mark-Light-120px-plus.png"></a><a id="linkedin" class="social" href="https://www.linkedin.com/in/alexplagman"><img src="http://www.alexplagman.com/img/li-transparent.png"></a></div><div id="copyright">&copy; 2017, Alex Plagman.</div></div></div></footer><script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script><script type="text/javascript" src="../../../../src/jquery.flexnav.min.js"></script><script src="../../../../src/jquery.matchHeight.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.0/jquery.scrollTo.min.js"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script type="text/javascript" src="../../../../src/gifffer.min.js"></script><script type="text/javascript" src="../../../../src/script.min.js"></script></body></html>